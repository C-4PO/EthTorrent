{"version":3,"sources":["../src/popup.js"],"names":["POPUP_PARAMS","getPopup","url","params","style","document","createElement","innerHTML","headerStyles","head","getElementsByTagName","appendChild","popup","window","open","closed","close","err","resolve","iframe","Iframe","_loadPopup","reject","location","href","result","addEventListener","e","data","origin","type","postMessage","focus","_addPageLoader","removeEventListener","container","id","preloader","closeButton","body","getElementById"],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;;;AAEA,IAAMA,8HAAN;;AAEA,IAAMC,WAAW,SAAXA,QAAW,OAAqB;AAAA,MAAlBC,GAAkB,QAAlBA,GAAkB;AAAA,MAAbC,MAAa,QAAbA,MAAa;;AACpC;AACA,MAAMC,QAAQC,SAASC,aAAT,CAAuB,OAAvB,CAAd;AACAF,QAAMG,SAAN,GAAkBC,gBAAlB;AACA,MAAMC,OAAOJ,SAASI,IAAT,IAAiBJ,SAASK,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAA9B;AACAD,OAAKE,WAAL,CAAiBP,KAAjB;;AAEA;AACA,MAAIQ,QAAQC,OAAOC,IAAP,CAAY,EAAZ,EAAgB,QAAhB,EAA0Bd,YAA1B,CAAZ;AACA,MAAI,CAACY,KAAD,IAAUA,MAAMG,MAAhB,IAA0B,OAAOH,MAAMG,MAAb,IAAqB,WAAnD,EAAgE;AAC9D,QAAI;AAAEH,YAAMI,KAAN;AAAe,KAArB,CAAsB,OAAOC,GAAP,EAAY,CAAE;AACpC,WAAO,kBAAQC,OAAR,CAAgB,EAAEC,QAAQ,IAAIC,gBAAJ,CAAWlB,GAAX,EAAgBC,MAAhB,CAAV,EAAhB,CAAP;AACD;AACD,SAAOkB,WAAW,EAAEnB,QAAF,EAAOU,YAAP,EAAcT,cAAd,EAAX,CAAP;AACD,CAdD;;AAgBA,IAAMkB,aAAa,SAAbA,UAAa;AAAA,MAAGnB,GAAH,SAAGA,GAAH;AAAA,MAAQU,KAAR,SAAQA,KAAR;AAAA,MAAeT,MAAf,SAAeA,MAAf;AAAA,SACjB,sBAAY,UAACe,OAAD,EAAUI,MAAV,EAAqB;AAC/BV,UAAMW,QAAN,CAAeC,IAAf,GAAsBtB,GAAtB;AACA,QAAIuB,SAAS,KAAb;AACAZ,WAAOa,gBAAP,CAAwB,SAAxB,EAAmC,UAACC,CAAD,EAAO;AACxC,UAAIF,MAAJ,EAAY;AAD4B,oBAEfE,EAAEC,IAFa;AAAA,UAEhCC,MAFgC,WAEhCA,MAFgC;AAAA,UAExBC,IAFwB,WAExBA,IAFwB;;AAGxC,UAAID,WAAW,YAAX,IAA2BC,SAAS,QAAxC,EAAkD;AAChDL,iBAAS,IAAT;AACAb,cAAMmB,WAAN,CAAkB,EAAEF,QAAQ,qBAAV,EAAiC1B,cAAjC,EAAlB,EAA6D,GAA7D;AACAS,cAAMoB,KAAN;AACAC,uBAAerB,KAAf;AACAM,gBAAQ,EAAEN,YAAF,EAAR;AACAC,eAAOqB,mBAAP,CAA2B,SAA3B,EAAsC,YAAW,CAAE,CAAnD;AACD;AACF,KAXD,EAWG,KAXH;AAYD,GAfD,CADiB;AAAA,CAAnB;;AAmBA,IAAMD,iBAAiB,SAAjBA,cAAiB,CAACrB,KAAD,EAAW;AAChC,MAAMuB,YAAY9B,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACA6B,YAAUC,EAAV;AACAD,YAAU/B,KAAV;AAWA;AACA,MAAMiC,mLAAN;;AAEA;AACA,MAAMC,cAAc,mEAApB;;AAEAH,YAAU5B,SAAV,GAAsB+B,cAAcD,SAApC;AACAhC,WAASkC,IAAT,CAAc5B,WAAd,CAA0BwB,SAA1B;;AAEA9B,WAASmC,cAAT,CAAwB,yBAAxB,EAAmDd,gBAAnD,CAAoE,OAApE,EAA6E,YAAM;AACjFd,UAAMI,KAAN;AACD,GAFD;AAGD,CA1BD;;kBA4Bef,Q","file":"popup.js","sourcesContent":["import Iframe from './iframe'\nimport headerStyles from './styles'\n\nconst POPUP_PARAMS = `scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=375,height=350,left=-500,top=150`\n\nconst getPopup = ({ url, params }) => {\n  /* INITIALIZE HEADER STYLES */\n  const style = document.createElement('style')\n  style.innerHTML = headerStyles\n  const head = document.head || document.getElementsByTagName('head')[0]\n  head.appendChild(style)\n\n  /* INITIALIZE POPUP DIALOG */\n  var popup = window.open('', '_blank', POPUP_PARAMS)\n  if (!popup || popup.closed || typeof popup.closed=='undefined') {\n    try { popup.close() } catch (err) {}\n    return Promise.resolve({ iframe: new Iframe(url, params) })\n  }\n  return _loadPopup({ url, popup, params })\n}\n\nconst _loadPopup = ({ url, popup, params }) =>\n  new Promise((resolve, reject) => {\n    popup.location.href = url\n    var result = false\n    window.addEventListener('message', (e) => {\n      if (result) return\n      const { origin, type } = e.data\n      if (origin === 'squarelink' && type === 'onload') {\n        result = true\n        popup.postMessage({ origin: 'squarelink-web3-sdk', params }, '*')\n        popup.focus()\n        _addPageLoader(popup)\n        resolve({ popup })\n        window.removeEventListener('message', function() {})\n      }\n    }, false)\n  })\n\n\nconst _addPageLoader = (popup) => {\n  const container = document.createElement('div')\n  container.id = `squarelink-preloader-container`\n  container.style = `\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    z-index: 2147483647;\n    background: rgba(0,0,0,0.5);\n  `\n  /* INITIALIZE PRELOADER */\n  const preloader = `<div class=\"squarelink-preloader\" id=\"squarelink-preloader\"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>`\n\n  /* INITIALIZE CLOSE BUTTON */\n  const closeButton = '<div class=\"squarelink-close\" id=\"squarelink-close-button\"></div>'\n\n  container.innerHTML = closeButton + preloader\n  document.body.appendChild(container)\n\n  document.getElementById('squarelink-close-button').addEventListener('click', () => {\n    popup.close()\n  })\n}\n\nexport default getPopup\n"]}