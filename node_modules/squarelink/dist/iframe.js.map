{"version":3,"sources":["../src/iframe.js"],"names":["Iframe","url","params","open","_createIframe","_addCloseListeners","_addMessageListeners","container","parentNode","removeChild","onClosed","error","addEventListener","close","self","document","onkeydown","evt","window","event","keyCode","paramsSent","e","data","origin","height","type","iframe","style","styles","contentWindow","postMessage","createElement","id","preloader","innerHTML","src","IFRAME_URL","encodeURI","onload","pl","getElementById","appendChild","body","border"],"mappings":"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","file":"iframe.js","sourcesContent":["import { IFRAME_URL } from './config'\n\nexport default class Iframe {\n  /**\n   * @param {string} url\n   */\n  constructor(url, params) {\n    this.url = url\n    this.params = params\n    this.open = true\n    this._createIframe()\n    this._addCloseListeners()\n    this._addMessageListeners()\n  }\n\n  close() {\n    if (!this.open) return\n    this.container.parentNode.removeChild(this.container)\n    if (this.onClosed) this.onClosed(this.error)\n    this.open = false\n  }\n\n  _addCloseListeners() {\n    this.container.addEventListener('click', () => { this.close() })\n    var self = this\n    document.onkeydown = (evt) => {\n      evt = evt || window.event\n      if (evt.keyCode == 27 && self.open) {\n        self.close()\n      }\n    }\n  }\n\n  _addMessageListeners() {\n    var self = this\n    var paramsSent = false\n    window.addEventListener('message', (e) => {\n      const { origin, height, type, error } = e.data\n      if (origin === 'squarelink-iframe') {\n        if (type === 'resize') {\n          self.iframe.style = styles.iframe(`${height}px`, 'none')\n          return\n        } else if (type === 'error') {\n          self.error = error\n          self.close()\n        } else if (type === 'onload' && !paramsSent) {\n          paramsSent = true\n          this.iframe.contentWindow.postMessage({\n            origin: 'squarelink-web3-sdk',\n            params: this.params\n          }, '*')\n        }\n      }\n    }, false)\n  }\n\n  _createIframe() {\n    /* INITIALIZE IFRAME CONTAINER */\n    const container = document.createElement('div')\n    container.id = `squarelink-iframe-container`\n    container.style = styles.container\n\n    /* INITIALIZE PRELOADER */\n    const preloader = `<div class=\"squarelink-preloader\" id=\"squarelink-preloader\"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>`\n    container.innerHTML = preloader\n\n    /* INITIALIZE IFRAME */\n    const iframe = document.createElement('iframe')\n    iframe.src = `${IFRAME_URL}/?url=${encodeURI(this.url)}`\n    iframe.id = `squarelink-iframe`\n    iframe.style = styles.iframe()\n    iframe.onload = function() {\n      const pl = document.getElementById('squarelink-preloader')\n      pl.parentNode.removeChild(pl)\n    }\n    container.appendChild(iframe)\n    this.iframe = iframe\n    this.container = container\n\n    /* LOAD IFRAME CONTAINER */\n    document.body.appendChild(container)\n  }\n}\n\nconst styles = {\n  iframe: function (height='200px', border=`3px solid #fff`) {\n    return `\n      position: absolute;\n      height: ${height};\n      width: 360px;\n      top: 50%;\n      left: 50%;\n      transform:\n      translate(-50%, -50%);\n      border: 0px transparent;\n      border-radius: 10px;\n      -webkit-border-radius: 10px;\n      -moz-border-radius: 10px;\n      border-radius: 10px;\n      -khtml-border-radius: 10px;\n      border: ${border};\n      z-index: 2147483647;\n      box-shadow: 0 10px 30px 4px rgba(0,0,0,.33);\n      background: none;\n    `\n  },\n  container: `\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    z-index: 2147483647;\n    background: rgba(0,0,0,0.5);\n  `\n}\n"]}